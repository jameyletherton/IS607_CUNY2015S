-- ORGANIZATION CHART
-- COMPANY NAME; GOOD HEALTH PLAN
-- Project "OMB-15" team members reports directly CEO

DROP TABLE IF EXISTS Employee_T;


CREATE TABLE Employee_T
(
  EMP_ID varchar PRIMARY KEY,
  EMP_Name varchar NOT NULL,
  DEPARTMENT varchar NULL,
  JOB_TITLE varchar NOT NULL,
  Manager_ID varchar NULL,
  Project_ID varchar NULL
  
);


INSERT INTO Employee_T ( EMP_ID, EMP_Name, DEPARTMENT, JOB_TITLE, Manager_ID, Project_ID ) VALUES ( '00001', 'JAMEY LEE ETHERTON', NULL, 'CEO', NULL, 'OBM-15');
INSERT INTO Employee_T ( EMP_ID, EMP_Name, DEPARTMENT, JOB_TITLE, Manager_ID, Project_ID ) VALUES ( '00002', 'IVY LESLIE NAKAMURA', 'SALES', 'VP', '00001', NULL);
INSERT INTO Employee_T ( EMP_ID, EMP_Name, DEPARTMENT, JOB_TITLE, Manager_ID, Project_ID ) VALUES ( '00003', 'SAMUEL ROBERT GATE', 'OPERATIONS', 'COO','00001', NULL);
INSERT INTO Employee_T ( EMP_ID, EMP_Name, DEPARTMENT, JOB_TITLE, Manager_ID, Project_ID ) VALUES ( '00004', 'DONALD JACKSON CHUCK', 'MARKETING', 'VP', '00001', NULL);
INSERT INTO Employee_T ( EMP_ID, EMP_Name, DEPARTMENT, JOB_TITLE, Manager_ID, Project_ID ) VALUES ( '00005', 'STEVE PAUL IHA', 'FINANCE', 'CFO','00001','OBM-15');
INSERT INTO Employee_T ( EMP_ID, EMP_Name, DEPARTMENT, JOB_TITLE, Manager_ID, Project_ID ) VALUES ( '00006', 'TANG SONG', 'SALES', 'manager', '00002', NULL);
INSERT INTO Employee_T ( EMP_ID, EMP_Name, DEPARTMENT, JOB_TITLE, Manager_ID, Project_ID ) VALUES ( '00007', 'IRIS HONU FUJII', 'ACCOUNTING','CONTROLLER','00005',NULL);
INSERT INTO Employee_T ( EMP_ID, EMP_Name, DEPARTMENT, JOB_TITLE, Manager_ID, Project_ID ) VALUES ( '00008', 'THOMAS JESUS OLGUIN', 'SALES','COMMERCIAL','00001','OBM-15');
INSERT INTO Employee_T ( EMP_ID, EMP_Name, DEPARTMENT, JOB_TITLE, Manager_ID, Project_ID ) VALUES ( '00009', 'ERIC JOSHUA TEMPLMANN', 'SALES', 'MEDICARE', '00006', NULL);
INSERT INTO Employee_T ( EMP_ID, EMP_Name, DEPARTMENT, JOB_TITLE, Manager_ID, Project_ID ) VALUES ( '00010', 'JULIE KANG THAI', 'OPERATIONS', 'RESEARCH', '00001', 'OMB-15');
INSERT INTO Employee_T ( EMP_ID, EMP_Name, DEPARTMENT, JOB_TITLE, Manager_ID, Project_ID ) VALUES ( '00011', 'MARK STEVE RICE', 'COMPLIANCE','VP','00003', NULL);
INSERT INTO Employee_T ( EMP_ID, EMP_Name, DEPARTMENT, JOB_TITLE, Manager_ID, Project_ID ) VALUES ( '00012', 'STEVE JEFFERSON JOBS', 'HR','MANAGER','00001',NULL);




SELECT 
E.EMP_ID AS EMPLOYEE_ID,
E.EMP_NAME AS NAME,
E.DEPARTMENT AS DEPT,
E.JOB_TITLE AS JOB_TITLE,
CONCAT(MANAGERS.EMP_NAME,'-', MANAGERS.JOB_TITLE) AS MANAGER,
E.Project_ID AS PROJECT 
FROM PUBLIC.Employee_T E
INNER JOIN PUBLIC.Employee_T MANAGERS ON E.Manager_ID = MANAGERS.EMP_ID
order by E.EMP_ID;


